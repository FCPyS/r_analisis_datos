<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Uso de R para la investigación social - 4&nbsp; Fusionado</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./P5.html" rel="next">
<link href="./P3.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./P4.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fusionado</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Uso de R para la investigación social</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/fcpys/r_ccss_2025/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Uso de R para la investigación social</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./instala.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instalación de R y Rstudio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Primer acercamiento al uso del programa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Importación de conjuntos de datos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Análisis descriptivo</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P4.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fusionado</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Ponderación y otros</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Análisis descriptivo II</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#presentación" id="toc-presentación" class="nav-link active" data-scroll-target="#presentación"><span class="header-section-number">4.1</span> Presentación</a></li>
  <li><a href="#fusionado-de-conjuntos-de-datos" id="toc-fusionado-de-conjuntos-de-datos" class="nav-link" data-scroll-target="#fusionado-de-conjuntos-de-datos"><span class="header-section-number">4.2</span> Fusionado de conjuntos de datos</a></li>
  <li><a href="#juntando-bases" id="toc-juntando-bases" class="nav-link" data-scroll-target="#juntando-bases"><span class="header-section-number">4.3</span> Juntando bases</a></li>
  <li><a href="#merge-con-id-compuesto" id="toc-merge-con-id-compuesto" class="nav-link" data-scroll-target="#merge-con-id-compuesto"><span class="header-section-number">4.4</span> Merge con id compuesto</a></li>
  <li><a href="#bases-de-distinto-tamaño" id="toc-bases-de-distinto-tamaño" class="nav-link" data-scroll-target="#bases-de-distinto-tamaño"><span class="header-section-number">4.5</span> Bases de distinto tamaño</a></li>
  <li><a href="#cuatro-formas-de-hacer-un-fusionado" id="toc-cuatro-formas-de-hacer-un-fusionado" class="nav-link" data-scroll-target="#cuatro-formas-de-hacer-un-fusionado"><span class="header-section-number">4.6</span> Cuatro formas de hacer un fusionado</a>
  <ul class="collapse">
  <li><a href="#casos-en-ambas-bases" id="toc-casos-en-ambas-bases" class="nav-link" data-scroll-target="#casos-en-ambas-bases"><span class="header-section-number">4.6.1</span> Casos en ambas bases</a></li>
  <li><a href="#todos-los-casos" id="toc-todos-los-casos" class="nav-link" data-scroll-target="#todos-los-casos"><span class="header-section-number">4.6.2</span> Todos los casos</a></li>
  <li><a href="#casos-en-la-base-1" id="toc-casos-en-la-base-1" class="nav-link" data-scroll-target="#casos-en-la-base-1"><span class="header-section-number">4.6.3</span> Casos en la base 1</a></li>
  <li><a href="#casos-de-la-base-2" id="toc-casos-de-la-base-2" class="nav-link" data-scroll-target="#casos-de-la-base-2"><span class="header-section-number">4.6.4</span> Casos de la base 2</a></li>
  </ul></li>
  <li><a href="#las-cuatro-formas-en-dplyr" id="toc-las-cuatro-formas-en-dplyr" class="nav-link" data-scroll-target="#las-cuatro-formas-en-dplyr"><span class="header-section-number">4.7</span> Las cuatro formas en <code>dplyr</code></a></li>
  <li><a href="#cheatsheet-de-dplyr" id="toc-cheatsheet-de-dplyr" class="nav-link" data-scroll-target="#cheatsheet-de-dplyr"><span class="header-section-number">4.8</span> Cheatsheet de <code>{dplyr}</code></a></li>
  <li><a href="#ejercicio" id="toc-ejercicio" class="nav-link" data-scroll-target="#ejercicio"><span class="header-section-number">4.9</span> Ejercicio</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/fcpys/r_ccss_2025/edit/main/P4.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/fcpys/r_ccss_2025/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fusionado</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="presentación" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="presentación"><span class="header-section-number">4.1</span> Presentación</h2>
<p>Aquí dejo la presentación</p>
<iframe src="./s3fusionado_ppt2023.pdf" title="Fusionado" width="600" height="400">
</iframe>
</section>
<section id="fusionado-de-conjuntos-de-datos" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="fusionado-de-conjuntos-de-datos"><span class="header-section-number">4.2</span> Fusionado de conjuntos de datos</h2>
<p>Vamos a trabajar con esta base de datos de la ENIGH 2022, que tiene tablas separadas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>) <span class="co"># instala pacman si se requiere</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: pacman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(skimr,tidyverse, magrittr, <span class="co"># sobretodo para dplyr</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>              haven, readxl, <span class="co">#importación</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>              janitor, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>              sjlabelled) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hoy cargamos la versión seccionada de la base</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>viviendas <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"datos/viviendas.sav"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>concentrado <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"datos/concentradohogar.sav"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>poblacion<span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"datos/poblacion.sav"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="juntando-bases" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="juntando-bases"><span class="header-section-number">4.3</span> Juntando bases</h2>
<p>Muchas bases de datos están organizadas en varias tablas. La ventaja de la programación por objetos de R, nos permite tener las bases cargadas en nuestro ambiente y llamarlas y juntarlas cuando sea necesario.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(viviendas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 88823    64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(viviendas[,<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "folioviv"   "tipo_viv"   "mat_pared"  "mat_techos" "mat_pisos" 
 [6] "antiguedad" "antigua_ne" "cocina"     "cocina_dor" "cuart_dorm"
[11] "num_cuarto" "disp_agua"  "dotac_agua" "excusado"   "uso_compar"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(concentrado)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 90102   126</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(concentrado[,<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "folioviv"   "foliohog"   "ubica_geo"  "tam_loc"    "est_socio" 
 [6] "est_dis"    "upm"        "factor"     "clase_hog"  "sexo_jefe" 
[11] "edad_jefe"  "educa_jefe" "tot_integ"  "hombres"    "mujeres"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(poblacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 309684    188</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(poblacion[,<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "folioviv"   "foliohog"   "numren"     "parentesco" "sexo"      
 [6] "edad"       "madre_hog"  "madre_id"   "padre_hog"  "padre_id"  
[11] "disc_camin" "disc_ver"   "disc_brazo" "disc_apren" "disc_oir"  </code></pre>
</div>
</div>
<p>Para juntar bases usamos el comando <code>merge()</code></p>
<p>En <code>by =</code> ponemos el <code>id</code>, correspondiente a la variable o variables que lo conforman, de manera entrecomillada o de vector. Cuando estamos mezclando bases del mismo nivel de análisis el <code>id</code> es igual en ambas bases. Cuando estamos incorporando información de bases de distinto nivel debemos escoger el nivel mayor.</p>
<p>En este caso, sabemos que a una vivienda corresponde más de un hogar (1 a muchos). Esto se puede revisar documentación, sabemos que el <code>id</code> de la tabla <code>viviendas</code> es <code>folioviv</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>merge_data<span class="ot">&lt;-</span> <span class="fu">merge</span>(viviendas, concentrado, <span class="at">by=</span><span class="st">"folioviv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esto es equivalente a <code>left_join()</code> de <code>{dplyr}</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>merge_data <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(viviendas, concentrado, <span class="at">by=</span><span class="st">"folioviv"</span>) </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>merge_data <span class="ot">&lt;-</span> viviendas <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(concentrado, <span class="at">by=</span><span class="st">"folioviv"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Revisemos la base creada</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(merge_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "folioviv"    "tipo_viv"    "mat_pared"   "mat_techos"  "mat_pisos"  
  [6] "antiguedad"  "antigua_ne"  "cocina"      "cocina_dor"  "cuart_dorm" 
 [11] "num_cuarto"  "disp_agua"   "dotac_agua"  "excusado"    "uso_compar" 
 [16] "sanit_agua"  "biodigest"   "bano_comp"   "bano_excus"  "bano_regad" 
 [21] "drenaje"     "disp_elect"  "focos_inca"  "focos_ahor"  "combustible"
 [26] "estufa_chi"  "eli_basura"  "tenencia"    "renta"       "estim_pago" 
 [31] "pago_viv"    "pago_mesp"   "tipo_adqui"  "viv_usada"   "tipo_finan" 
 [36] "num_dueno1"  "hog_dueno1"  "num_dueno2"  "hog_dueno2"  "escrituras" 
 [41] "lavadero"    "fregadero"   "regadera"    "tinaco_azo"  "cisterna"   
 [46] "pileta"      "calent_sol"  "calent_gas"  "medidor_luz" "bomba_agua" 
 [51] "tanque_gas"  "aire_acond"  "calefacc"    "tot_resid"   "tot_hom"    
 [56] "tot_muj"     "tot_hog"     "ubica_geo.x" "tam_loc.x"   "est_socio.x"
 [61] "est_dis.x"   "upm.x"       "factor.x"    "procaptar"   "foliohog"   
 [66] "ubica_geo.y" "tam_loc.y"   "est_socio.y" "est_dis.y"   "upm.y"      
 [71] "factor.y"    "clase_hog"   "sexo_jefe"   "edad_jefe"   "educa_jefe" 
 [76] "tot_integ"   "hombres"     "mujeres"     "mayores"     "menores"    
 [81] "p12_64"      "p65mas"      "ocupados"    "percep_ing"  "perc_ocupa" 
 [86] "ing_cor"     "ingtrab"     "trabajo"     "sueldos"     "horas_extr" 
 [91] "comisiones"  "aguinaldo"   "indemtrab"   "otra_rem"    "remu_espec" 
 [96] "negocio"     "noagrop"     "industria"   "comercio"    "servicios"  
[101] "agrope"      "agricolas"   "pecuarios"   "reproducc"   "pesca"      
[106] "otros_trab"  "rentas"      "utilidad"    "arrenda"     "transfer"   
[111] "jubilacion"  "becas"       "donativos"   "remesas"     "bene_gob"   
[116] "transf_hog"  "trans_inst"  "estim_alqu"  "otros_ing"   "gasto_mon"  
[121] "alimentos"   "ali_dentro"  "cereales"    "carnes"      "pescado"    
[126] "leche"       "huevo"       "aceites"     "tuberculo"   "verduras"   
[131] "frutas"      "azucar"      "cafe"        "especias"    "otros_alim" 
[136] "bebidas"     "ali_fuera"   "tabaco"      "vesti_calz"  "vestido"    
[141] "calzado"     "vivienda"    "alquiler"    "pred_cons"   "agua"       
[146] "energia"     "limpieza"    "cuidados"    "utensilios"  "enseres"    
[151] "salud"       "atenc_ambu"  "hospital"    "medicinas"   "transporte" 
[156] "publico"     "foraneo"     "adqui_vehi"  "mantenim"    "refaccion"  
[161] "combus"      "comunica"    "educa_espa"  "educacion"   "esparci"    
[166] "paq_turist"  "personales"  "cuida_pers"  "acces_pers"  "otros_gas"  
[171] "transf_gas"  "percep_tot"  "retiro_inv"  "prestamos"   "otras_perc" 
[176] "ero_nm_viv"  "ero_nm_hog"  "erogac_tot"  "cuota_viv"   "mater_serv" 
[181] "material"    "servicio"    "deposito"    "prest_terc"  "pago_tarje" 
[186] "deudas"      "balance"     "otras_erog"  "smg"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merge_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 90102   189</code></pre>
</div>
</div>
<p>Algunos elementos</p>
<ol type="1">
<li><p>El orden de las variables corresponde al orden que pusimos las bases en las opciones.</p></li>
<li><p>También vemos que las variables que se repetían en ambas bases se repiten en la nueva base,con un sufijo <code>.x</code>, para lo que proviene de la primera base y con <code>.y</code>, lo que proviene de la segunda. R dejará las variables intactas y son coincidentes, en nuestro caso, porque las variables son iguales. R hace esto para prever que por error tengamos alguna variable con un nombre igual y no sea la misma en su contenido.</p></li>
</ol>
</section>
<section id="merge-con-id-compuesto" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="merge-con-id-compuesto"><span class="header-section-number">4.4</span> Merge con id compuesto</h2>
<p>Los identificadores pueden estar compuestos de más de una variable:</p>
<ul>
<li>Viviendas <code>viviendas</code> es <code>folioviv</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>viviendas <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">get_dupes</span>(folioviv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No duplicate combinations found of: folioviv</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 65
# ℹ 65 variables: folioviv &lt;chr&gt;, dupe_count &lt;int&gt;, tipo_viv &lt;chr+lbl&gt;,
#   mat_pared &lt;chr+lbl&gt;, mat_techos &lt;chr+lbl&gt;, mat_pisos &lt;chr+lbl&gt;,
#   antiguedad &lt;dbl&gt;, antigua_ne &lt;chr+lbl&gt;, cocina &lt;chr+lbl&gt;,
#   cocina_dor &lt;chr+lbl&gt;, cuart_dorm &lt;dbl&gt;, num_cuarto &lt;dbl&gt;,
#   disp_agua &lt;chr+lbl&gt;, dotac_agua &lt;chr+lbl&gt;, excusado &lt;chr+lbl&gt;,
#   uso_compar &lt;chr+lbl&gt;, sanit_agua &lt;chr+lbl&gt;, biodigest &lt;chr+lbl&gt;,
#   bano_comp &lt;dbl&gt;, bano_excus &lt;dbl&gt;, bano_regad &lt;dbl&gt;, drenaje &lt;chr+lbl&gt;, …</code></pre>
</div>
</div>
<ul>
<li>concentrado <code>concentrado</code> es <code>c("folioviv", "foliohog")</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>concentrado <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">get_dupes</span>(<span class="fu">c</span>(folioviv, foliohog))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No duplicate combinations found of: folioviv, foliohog</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 127
# ℹ 127 variables: folioviv &lt;chr&gt;, foliohog &lt;chr&gt;, dupe_count &lt;int&gt;,
#   ubica_geo &lt;chr+lbl&gt;, tam_loc &lt;chr+lbl&gt;, est_socio &lt;chr+lbl&gt;, est_dis &lt;chr&gt;,
#   upm &lt;chr&gt;, factor &lt;dbl&gt;, clase_hog &lt;chr+lbl&gt;, sexo_jefe &lt;chr+lbl&gt;,
#   edad_jefe &lt;dbl&gt;, educa_jefe &lt;chr+lbl&gt;, tot_integ &lt;dbl&gt;, hombres &lt;dbl&gt;,
#   mujeres &lt;dbl&gt;, mayores &lt;dbl&gt;, menores &lt;dbl&gt;, p12_64 &lt;dbl&gt;, p65mas &lt;dbl&gt;,
#   ocupados &lt;dbl&gt;, percep_ing &lt;dbl&gt;, perc_ocupa &lt;dbl&gt;, ing_cor &lt;dbl&gt;,
#   ingtrab &lt;dbl&gt;, trabajo &lt;dbl&gt;, sueldos &lt;dbl&gt;, horas_extr &lt;dbl&gt;, …</code></pre>
</div>
</div>
<ul>
<li>Poblacion <code>individuos</code> es <code>c("folioviv", "foliohog", "numren")</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>poblacion <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">get_dupes</span>(<span class="fu">c</span>(folioviv, foliohog, numren))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No duplicate combinations found of: folioviv, foliohog, numren</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 189
# ℹ 189 variables: folioviv &lt;chr&gt;, foliohog &lt;chr&gt;, numren &lt;chr&gt;,
#   dupe_count &lt;int&gt;, parentesco &lt;chr+lbl&gt;, sexo &lt;chr+lbl&gt;, edad &lt;dbl&gt;,
#   madre_hog &lt;chr+lbl&gt;, madre_id &lt;chr&gt;, padre_hog &lt;chr+lbl&gt;, padre_id &lt;chr&gt;,
#   disc_camin &lt;chr+lbl&gt;, disc_ver &lt;chr+lbl&gt;, disc_brazo &lt;chr+lbl&gt;,
#   disc_apren &lt;chr+lbl&gt;, disc_oir &lt;chr+lbl&gt;, disc_vest &lt;chr+lbl&gt;,
#   disc_habla &lt;chr+lbl&gt;, disc_acti &lt;chr+lbl&gt;, cau_camin &lt;chr+lbl&gt;,
#   cau_ver &lt;chr+lbl&gt;, cau_brazo &lt;chr+lbl&gt;, cau_apren &lt;chr+lbl&gt;, …</code></pre>
</div>
</div>
<p>Esto es un <code>id compuesto</code>. No es una sola variable. Para esto modificamos ligeramente cómo ponemos el <code>by =</code>, pero siempre eligiendo el id de la base de mayor nivel. (Tené cuidado con los paréntesis)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>merge_data2<span class="ot">&lt;-</span> <span class="fu">merge</span>(concentrado, poblacion, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"folioviv"</span>, <span class="st">"foliohog"</span>))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merge_data2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 309684    312</code></pre>
</div>
</div>
<p>Revisemos la base</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>merge_data2 <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         folioviv foliohog ubica_geo tam_loc est_socio est_dis.x   upm.x
309679 3260797909        1     32046       4         2       560 0010232
309680 3260797910        1     32046       4         2       560 0010232
309681 3260797910        1     32046       4         2       560 0010232
309682 3260797912        1     32046       4         2       560 0010232
309683 3260797912        1     32046       4         2       560 0010232
309684 3260797912        1     32046       4         2       560 0010232
       factor.x clase_hog sexo_jefe edad_jefe educa_jefe tot_integ hombres
309679      123         2         1        37         04         4       2
309680      123         2         1        63         06         2       1
309681      123         2         1        63         06         2       1
309682      123         2         1        29         10         3       1
309683      123         2         1        29         10         3       1
309684      123         2         1        29         10         3       1
       mujeres mayores menores p12_64 p65mas ocupados percep_ing perc_ocupa
309679       2       2       2      2      0        1          1          1
309680       1       2       0      2      0        2          1          1
309681       1       2       0      2      0        2          1          1
309682       2       2       1      2      0        2          2          2
309683       2       2       1      2      0        2          2          2
309684       2       2       1      2      0        2          2          2
         ing_cor   ingtrab  trabajo  sueldos horas_extr comisiones aguinaldo
309679  27055.89  26413.04 26413.04 26413.04          0          0         0
309680 159450.69 136709.99     0.00     0.00          0          0         0
309681 159450.69 136709.99     0.00     0.00          0          0         0
309682  43633.12  38739.12     0.00     0.00          0          0         0
309683  43633.12  38739.12     0.00     0.00          0          0         0
309684  43633.12  38739.12     0.00     0.00          0          0         0
       indemtrab otra_rem remu_espec   negocio   noagrop industria comercio
309679         0        0          0      0.00      0.00         0        0
309680         0        0          0 136709.99 136709.99         0   136710
309681         0        0          0 136709.99 136709.99         0   136710
309682         0        0          0  38739.12  38739.12         0        0
309683         0        0          0  38739.12  38739.12         0        0
309684         0        0          0  38739.12  38739.12         0        0
       servicios agrope agricolas pecuarios reproducc pesca otros_trab rentas
309679      0.00      0         0         0         0     0          0      0
309680      0.00      0         0         0         0     0          0      0
309681      0.00      0         0         0         0     0          0      0
309682  38739.12      0         0         0         0     0          0      0
309683  38739.12      0         0         0         0     0          0      0
309684  38739.12      0         0         0         0     0          0      0
       utilidad arrenda transfer jubilacion becas donativos remesas bene_gob
309679        0       0   642.85          0     0         0       0        0
309680        0       0 14031.03          0     0         0       0        0
309681        0       0 14031.03          0     0         0       0        0
309682        0       0  2571.42          0     0         0       0        0
309683        0       0  2571.42          0     0         0       0        0
309684        0       0  2571.42          0     0         0       0        0
       transf_hog trans_inst estim_alqu otros_ing gasto_mon alimentos
309679     642.85          0       0.00         0  18702.34   6325.68
309680   14031.03          0    8709.67         0 117455.55  59322.63
309681   14031.03          0    8709.67         0 117455.55  59322.63
309682    2571.42          0    2322.58         0  30166.09  13512.73
309683    2571.42          0    2322.58         0  30166.09  13512.73
309684    2571.42          0    2322.58         0  30166.09  13512.73
       ali_dentro cereales  carnes pescado   leche   huevo aceites tuberculo
309679    4204.26  1157.13 2057.14       0  989.99    0.00       0      0.00
309680   51608.35 10697.09    0.00       0 2854.27 1028.56       0   2288.56
309681   51608.35 10697.09    0.00       0 2854.27 1028.56       0   2288.56
309682   11905.59  1414.26 1864.28       0 2455.69  321.42       0    488.57
309683   11905.59  1414.26 1864.28       0 2455.69  321.42       0    488.57
309684   11905.59  1414.26 1864.28       0 2455.69  321.42       0    488.57
       verduras  frutas azucar    cafe especias otros_alim bebidas ali_fuera
309679     0.00    0.00      0    0.00     0.00       0.00    0.00   2121.42
309680  4847.08 1157.11      0 7328.57 13139.99    6377.13 1889.99   7714.28
309681  4847.08 1157.11      0 7328.57 13139.99    6377.13 1889.99   7714.28
309682  2121.39 1028.57      0    0.00     0.00    2211.41    0.00   1607.14
309683  2121.39 1028.57      0    0.00     0.00    2211.41    0.00   1607.14
309684  2121.39 1028.57      0    0.00     0.00    2211.41    0.00   1607.14
       tabaco vesti_calz vestido calzado vivienda alquiler pred_cons  agua
309679      0    1036.95    0.00 1036.95  4385.37  2322.58         0 181.5
309680      0       0.00    0.00    0.00   501.00     0.00       100 200.0
309681      0       0.00    0.00    0.00   501.00     0.00       100 200.0
309682      0     273.91  273.91    0.00   410.00     0.00        50   0.0
309683      0     273.91  273.91    0.00   410.00     0.00        50   0.0
309684      0     273.91  273.91    0.00   410.00     0.00        50   0.0
       energia limpieza cuidados utensilios enseres  salud atenc_ambu hospital
309679 1881.29  3028.03  3028.03          0     0.0    0.0        0.0        0
309680  201.00  5530.63  5530.63          0     0.0  782.6      782.6        0
309681  201.00  5530.63  5530.63          0     0.0  782.6      782.6        0
309682  360.00  1186.77   795.47          0   391.3 1956.5     1956.5        0
309683  360.00  1186.77   795.47          0   391.3 1956.5     1956.5        0
309684  360.00  1186.77   795.47          0   391.3 1956.5     1956.5        0
       medicinas transporte publico foraneo adqui_vehi mantenim refaccion
309679         0    2283.13       0       0          0  2283.13    831.52
309680         0   16259.12       0       0          0 14516.12      0.00
309681         0   16259.12       0       0          0 14516.12      0.00
309682         0    4383.87       0       0          0  3483.87      0.00
309683         0    4383.87       0       0          0  3483.87      0.00
309684         0    4383.87       0       0          0  3483.87      0.00
         combus comunica educa_espa educacion esparci paq_turist personales
309679  1451.61        0       0.00         0    0.00          0    1643.18
309680 14516.12     1743       0.00         0    0.00          0     435.48
309681 14516.12     1743       0.00         0    0.00          0     435.48
309682  3483.87      900    3913.04         0 3913.04          0    4529.27
309683  3483.87      900    3913.04         0 3913.04          0    4529.27
309684  3483.87      900    3913.04         0 3913.04          0    4529.27
       cuida_pers acces_pers otros_gas transf_gas percep_tot retiro_inv
309679    1643.18       0.00         0       0.00          0          0
309680     435.48       0.00         0   34624.09          0          0
309681     435.48       0.00         0   34624.09          0          0
309682    3794.49     234.78       500       0.00          0          0
309683    3794.49     234.78       500       0.00          0          0
309684    3794.49     234.78       500       0.00          0          0
       prestamos otras_perc ero_nm_viv ero_nm_hog erogac_tot cuota_viv
309679         0          0          0          0       0.00         0
309680         0          0          0          0   58451.08         0
309681         0          0          0          0   58451.08         0
309682         0          0          0          0    9538.04         0
309683         0          0          0          0    9538.04         0
309684         0          0          0          0    9538.04         0
       mater_serv material servicio deposito prest_terc pago_tarje deudas
309679          0        0        0     0.00          0          0      0
309680          0        0        0 58451.08          0          0      0
309681          0        0        0 58451.08          0          0      0
309682          0        0        0  9538.04          0          0      0
309683          0        0        0  9538.04          0          0      0
309684          0        0        0  9538.04          0          0      0
       balance otras_erog     smg numren parentesco sexo edad madre_hog
309679       0          0 15558.3     04        301    1    5         1
309680       0          0 15558.3     01        101    1   63         2
309681       0          0 15558.3     02        201    2   59         2
309682       0          0 15558.3     01        101    1   29         2
309683       0          0 15558.3     02        201    2   30         2
309684       0          0 15558.3     03        301    2    0         1
       madre_id padre_hog padre_id disc_camin disc_ver disc_brazo disc_apren
309679       02         1       01          4        4          4          4
309680                  2                   4        3          4          4
309681                  2                   4        3          4          4
309682                  2                   4        4          4          4
309683                  2                   4        4          4          4
309684       02         1       01          4        4          4          4
       disc_oir disc_vest disc_habla disc_acti cau_camin cau_ver cau_brazo
309679        4         4          4         4                            
309680        4         4          4         4                 2          
309681        4         4          4         4                 2          
309682        4         4          4         4                            
309683        4         4          4         4                            
309684        4         4          4         4                            
       cau_apren cau_oir cau_vest cau_habla cau_acti hablaind lenguaind
309679                                                      2          
309680                                                      2          
309681                                                      2          
309682                                                      2          
309683                                                      2          
309684                                                                 
       hablaesp comprenind etnia alfabetism asis_esc nivel grado tipoesc
309679                   2     2          2        1    01     3       1
309680                   2     2          1        2                    
309681                   2     2          1        2                    
309682                   2     2          1        2                    
309683                   2     2          1        2                    
309684                                                                  
       tiene_b otorg_b forma_b tiene_c otorg_c forma_c nivelaprob gradoaprob
309679       2                                                  1          2
309680                                                          3          3
309681                                                          3          3
309682                                                          7          5
309683                                                          7          5
309684                                                                      
       antec_esc residencia edo_conyug pareja_hog conyuge_id segsoc ss_aa ss_mm
309679                   32                                            NA    NA
309680                   32          2          1         02      2    NA    NA
309681                   32          2          1         01      2    NA    NA
309682         3         32          2          1         02      2    NA    NA
309683         3         32          2          1         01      2    NA    NA
309684                                                                 NA    NA
       redsoc_1 redsoc_2 redsoc_3 redsoc_4 redsoc_5 redsoc_6 hor_1 min_1
309679                                                          NA    NA
309680        2        3        3        3        3             56     0
309681                                                          NA    NA
309682        3        3        3        3        2        3    48     0
309683        3        2        3        4        2        2    10     0
309684                                                          NA    NA
       usotiempo1 hor_2 min_2 usotiempo2 hor_3 min_3 usotiempo3 hor_4 min_4
309679               NA    NA               NA    NA               NA    NA
309680               NA    NA          9    NA    NA          9    NA    NA
309681               NA    NA               NA    NA               NA    NA
309682               NA    NA          9    NA    NA          9    NA    NA
309683               NA    NA          9    NA    NA          9    NA    NA
309684               NA    NA               NA    NA               NA    NA
       usotiempo4 hor_5 min_5 usotiempo5 hor_6 min_6 usotiempo6 hor_7 min_7
309679               NA    NA               NA    NA               NA    NA
309680          9    NA    NA          9    NA    NA          9    NA    NA
309681               NA    NA               NA    NA               NA    NA
309682          9     2     0               NA    NA          9    NA    NA
309683          9    NA    NA          9    10     0               NA    NA
309684               NA    NA               NA    NA               NA    NA
       usotiempo7 hor_8 min_8 usotiempo8 pop_insabi atemed inst_1 inst_2 inst_3
309679               NA    NA                     2      2                     
309680          9    21     0                     2      2                     
309681               NA    NA                     2      2                     
309682          9    21     0                     2      2                     
309683          9    10     0                     2      2                     
309684               NA    NA                     2      2                     
       inst_4 inst_5 inst_6 inscr_1 inscr_2 inscr_3 inscr_4 inscr_5 inscr_6
309679                                                                     
309680                                                                     
309681                                                                     
309682                                                                     
309683                                                                     
309684                                                                     
       inscr_7 inscr_8 prob_anio prob_mes prob_sal aten_sal servmed_1 servmed_2
309679                      2022       06        1        1                    
309680                      2022       10        1        1                    
309681                      2018       03        1        1                    
309682                      2022       09        1        1                    
309683                      2022       06        1        1                    
309684                      2022       07        1        1                    
       servmed_3 servmed_4 servmed_5 servmed_6 servmed_7 servmed_8 servmed_9
309679                                                          08          
309680                                                          08          
309681                                                          08          
309682                                                          08          
309683                                                          08          
309684                                                          08          
       servmed_10 servmed_11 servmed_12 hh_lug mm_lug hh_esp mm_esp pagoaten_1
309679                                       0     10      0     10          1
309680                                       1      0      0      1           
309681                                       0     30      1      0           
309682                                       0      5      0     10          1
309683                                       0     22      0      5          1
309684                                       5      0      0      5          1
       pagoaten_2 pagoaten_3 pagoaten_4 pagoaten_5 pagoaten_6 pagoaten_7
309679          2                                                       
309680                                                                 7
309681                                                      6           
309682          2                                                       
309683          2                                                       
309684          2                                                       
       noatenc_1 noatenc_2 noatenc_3 noatenc_4 noatenc_5 noatenc_6 noatenc_7
309679                                                                      
309680                                                                      
309681                                                                      
309682                                                                      
309683                                                                      
309684                                                                      
       noatenc_8 noatenc_9 noatenc_10 noatenc_11 noatenc_12 noatenc_13
309679                                                                
309680                                                                
309681                                                                
309682                                                                
309683                                                                
309684                                                                
       noatenc_14 noatenc_15 noatenc_16 norecib_1 norecib_2 norecib_3 norecib_4
309679                                                                         
309680                                                                         
309681                                                                         
309682                                                                         
309683                                                                         
309684                                                                         
       norecib_5 norecib_6 norecib_7 norecib_8 norecib_9 norecib_10 norecib_11
309679                                                                        
309680                                                                        
309681                                                                        
309682                                                                        
309683                                                                        
309684                                                                        
       norecib_12 razon_1 razon_2 razon_3 razon_4 razon_5 razon_6 razon_7
309679                                                                   
309680                                                                   
309681                                                                   
309682                                                                   
309683                                                                   
309684                                                                   
       razon_8 razon_9 razon_10 razon_11 diabetes pres_alta peso segvol_1
309679                                                         1         
309680                                          1         1    1         
309681                                          1         1    1         
309682                                          2         1    1         
309683                                          2         1    1         
309684                                                         1         
       segvol_2 segvol_3 segvol_4 segvol_5 segvol_6 segvol_7 hijos_viv
309679                                                              NA
309680                                            6                 NA
309681                                            6                  4
309682                                            6                 NA
309683                                            6                  1
309684                                                              NA
       hijos_mue hijos_sob trabajo_mp motivo_aus act_pnea1 act_pnea2 num_trabaj
309679        NA        NA                                                     
309680        NA        NA          1                                         1
309681         0         4          1                                         1
309682        NA        NA          1                                         1
309683         0         1          1                                         1
309684        NA        NA                                                     
       c_futuro ct_futuro entidad est_dis.y   upm.y factor.y
309679                         32       560 0010232      123
309680                         32       560 0010232      123
309681                         32       560 0010232      123
309682                         32       560 0010232      123
309683                         32       560 0010232      123
309684                         32       560 0010232      123</code></pre>
</div>
</div>
</section>
<section id="bases-de-distinto-tamaño" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="bases-de-distinto-tamaño"><span class="header-section-number">4.5</span> Bases de distinto tamaño</h2>
<p>Hasta ahorita hemos hecho merge que son de unidades de distinto nivel y son incluyentes. A veces tenemos bases de datos que son de distinto tamaño y del mismo nivel. A veces las dos aportan casos y a veces aportan variables, y a veces, las dos aportan las dos cosas.</p>
<p>Vamos a revisar qué pasaría si quisiéramos incorporar la información los ingresos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(merge_data, merge_data2) <span class="co"># botamos otros ejemplos</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>ingresos<span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"datos/ingresos.sav"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esta base tiene otro ID</p>
<ul>
<li>Ingresos <code>ingresos</code> es <code>c("folioviv", "foliohog", "numren", "clave")</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>ingresos <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">get_dupes</span>(<span class="fu">c</span>(folioviv, foliohog, numren, clave))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No duplicate combinations found of: folioviv, foliohog, numren, clave</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 22
# ℹ 22 variables: folioviv &lt;chr&gt;, foliohog &lt;chr&gt;, numren &lt;chr&gt;,
#   clave &lt;chr+lbl&gt;, dupe_count &lt;int&gt;, mes_1 &lt;chr+lbl&gt;, mes_2 &lt;chr+lbl&gt;,
#   mes_3 &lt;chr+lbl&gt;, mes_4 &lt;chr+lbl&gt;, mes_5 &lt;chr+lbl&gt;, mes_6 &lt;chr+lbl&gt;,
#   ing_1 &lt;dbl&gt;, ing_2 &lt;dbl&gt;, ing_3 &lt;dbl&gt;, ing_4 &lt;dbl&gt;, ing_5 &lt;dbl&gt;,
#   ing_6 &lt;dbl&gt;, ing_tri &lt;dbl&gt;, entidad &lt;chr+lbl&gt;, est_dis &lt;chr&gt;, upm &lt;chr&gt;,
#   factor &lt;dbl&gt;</code></pre>
</div>
</div>
<p>¿Cuántas claves de ingreso hay?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>ingresos <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(clave)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> clave      n      percent
  P001 105685 2.660871e-01
  P002   2277 5.732888e-03
  P003   7733 1.946966e-02
  P004   7706 1.940168e-02
  P005   3325 8.371477e-03
  P006   8056 2.028289e-02
  P007   6676 1.680842e-02
  P008  18475 4.651520e-02
  P009  50726 1.277148e-01
  P011    371 9.340806e-04
  P012   3296 8.298463e-03
  P013      3 7.553212e-06
  P014   4752 1.196429e-02
  P015     47 1.183337e-04
  P016    676 1.701991e-03
  P018     11 2.769511e-05
  P019    297 7.477680e-04
  P020      1 2.517737e-06
  P021   1477 3.718698e-03
  P022  15569 3.919865e-02
  P023    775 1.951247e-03
  P024   2563 6.452961e-03
  P025    194 4.884411e-04
  P026    273 6.873423e-04
  P027    240 6.042570e-04
  P028    100 2.517737e-04
  P029     13 3.273059e-05
  P030      3 7.553212e-06
  P031    142 3.575187e-04
  P032  17420 4.385899e-02
  P033    828 2.084687e-03
  P034     38 9.567402e-05
  P035    178 4.481573e-04
  P036    912 2.296177e-03
  P037    465 1.170748e-03
  P038   3080 7.754631e-03
  P039    473 1.190890e-03
  P040  22391 5.637466e-02
  P041   6290 1.583657e-02
  P043   1612 4.058593e-03
  P045    650 1.636529e-03
  P048    793 1.996566e-03
  P049   1732 4.360721e-03
  P050     35 8.812081e-05
  P051  11024 2.775554e-02
  P052    860 2.165254e-03
  P053   4842 1.219088e-02
  P054    216 5.438313e-04
  P055     10 2.517737e-05
  P056      1 2.517737e-06
  P057     87 2.190432e-04
  P058    366 9.214919e-04
  P059     64 1.611352e-04
  P060    140 3.524832e-04
  P061    209 5.262071e-04
  P062    806 2.029296e-03
  P063   2717 6.840693e-03
  P064     23 5.790796e-05
  P065     77 1.938658e-04
  P066    223 5.614555e-04
  P067   1761 4.433736e-03
  P068   4882 1.229159e-02
  P069   6976 1.756374e-02
  P070   8075 2.033073e-02
  P071   5079 1.278759e-02
  P072   4113 1.035545e-02
  P073    185 4.657814e-04
  P074    198 4.985120e-04
  P075    735 1.850537e-03
  P076   1136 2.860150e-03
  P077   1472 3.706110e-03
  P078   1459 3.673379e-03
  P079   1260 3.172349e-03
  P080    105 2.643624e-04
  P081     49 1.233691e-04
  P101   7943 1.999839e-02
  P102   5346 1.345982e-02
  P103    647 1.628976e-03
  P104  22933 5.773927e-02
  P105   2036 5.126113e-03
  P106    329 8.283356e-04
  P107     66 1.661707e-04
  P108    373 9.391161e-04</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>ingresos_sueldos<span class="ot">&lt;-</span>ingresos <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(clave<span class="sc">==</span><span class="st">"P001"</span>) </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ingresos_sueldos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 105685     21</code></pre>
</div>
</div>
<p>Vamos a hacer el primer tipo de fusionado</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>merge_data3<span class="ot">&lt;-</span><span class="fu">merge</span>(poblacion, ingresos_sueldos, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"folioviv"</span>, <span class="st">"foliohog"</span>, <span class="st">"numren"</span>))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merge_data3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 105685    206</code></pre>
</div>
</div>
<p>¡La base nueva no tiene a todas las observaciones, solo la que tiene en la base más pequeña!</p>
</section>
<section id="cuatro-formas-de-hacer-un-fusionado" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="cuatro-formas-de-hacer-un-fusionado"><span class="header-section-number">4.6</span> Cuatro formas de hacer un fusionado</h2>
<p>En realidad hay cuatro formas de hacer un “merge”</p>
<section id="casos-en-ambas-bases" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="casos-en-ambas-bases"><span class="header-section-number">4.6.1</span> Casos en ambas bases</h3>
<p>Por <em>default</em>, el comando tiene activado la opción “all = FALSE”, que nos deja los datos de ambas bases comunes. (tipo una intersección)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>merge_data3<span class="ot">&lt;-</span><span class="fu">merge</span>(poblacion, </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                   ingresos_sueldos,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by=</span><span class="fu">c</span>(<span class="st">"folioviv"</span>, <span class="st">"foliohog"</span>, <span class="st">"numren"</span>), </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">all =</span> F)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merge_data3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 105685    206</code></pre>
</div>
</div>
</section>
<section id="todos-los-casos" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="todos-los-casos"><span class="header-section-number">4.6.2</span> Todos los casos</h3>
<p>Si cambiamos la opción “all = TRUE”, que nos deja los datos comunes a ambas bases. (como una unión)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>merge_data3<span class="ot">&lt;-</span><span class="fu">merge</span>(poblacion,</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                   ingresos_sueldos, </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by=</span><span class="fu">c</span>(<span class="st">"folioviv"</span>, <span class="st">"foliohog"</span>, <span class="st">"numren"</span>), </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">all =</span> T)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merge_data3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 309684    206</code></pre>
</div>
</div>
</section>
<section id="casos-en-la-base-1" class="level3" data-number="4.6.3">
<h3 data-number="4.6.3" class="anchored" data-anchor-id="casos-en-la-base-1"><span class="header-section-number">4.6.3</span> Casos en la base 1</h3>
<p>Si queremos quedarnos con todos los datos que hay en la primera base, x, vamos a usar a opción all.x = TRUE.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>merge_data3<span class="ot">&lt;-</span><span class="fu">merge</span>(poblacion, </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>                   ingresos_sueldos,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by=</span><span class="fu">c</span>(<span class="st">"folioviv"</span>, <span class="st">"foliohog"</span>, <span class="st">"numren"</span>), </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">all.x  =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merge_data3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 309684    206</code></pre>
</div>
</div>
</section>
<section id="casos-de-la-base-2" class="level3" data-number="4.6.4">
<h3 data-number="4.6.4" class="anchored" data-anchor-id="casos-de-la-base-2"><span class="header-section-number">4.6.4</span> Casos de la base 2</h3>
<p>Notamos que hoy sí tenemos los datos de toda la población y hay missings en las variables aportadas por la base de trabajo</p>
<p>Si queremos lo contrario, quedarnos con los datos aportados por la segunda base, y, vamos a usar la opción all.y=TRUE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>merge_data3<span class="ot">&lt;-</span><span class="fu">merge</span>(poblacion, </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>                   ingresos_sueldos,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by=</span><span class="fu">c</span>(<span class="st">"folioviv"</span>, <span class="st">"foliohog"</span>, <span class="st">"numren"</span>),</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">all.y  =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merge_data3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 105685    206</code></pre>
</div>
</div>
</section>
</section>
<section id="las-cuatro-formas-en-dplyr" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="las-cuatro-formas-en-dplyr"><span class="header-section-number">4.7</span> Las cuatro formas en <code>dplyr</code></h2>
<p>El caso 1:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>merge_data3<span class="ot">&lt;-</span>dplyr<span class="sc">::</span><span class="fu">inner_join</span>(poblacion,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                               ingresos_sueldos,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">by=</span><span class="fu">c</span>(<span class="st">"folioviv"</span>, <span class="st">"foliohog"</span>, <span class="st">"numren"</span>))</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merge_data3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 105685    206</code></pre>
</div>
</div>
<p>El caso 2:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>merge_data3<span class="ot">&lt;-</span>dplyr<span class="sc">::</span><span class="fu">full_join</span>(poblacion, </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                              ingresos_sueldos, </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by=</span><span class="fu">c</span>(<span class="st">"folioviv"</span>, <span class="st">"foliohog"</span>, <span class="st">"numren"</span>))</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merge_data3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 309684    206</code></pre>
</div>
</div>
<p>El caso 3:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>merge_data3<span class="ot">&lt;-</span>dplyr<span class="sc">::</span><span class="fu">left_join</span>(poblacion,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                              ingresos_sueldos, </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by=</span><span class="fu">c</span>(<span class="st">"folioviv"</span>, <span class="st">"foliohog"</span>, <span class="st">"numren"</span>))</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merge_data3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 309684    206</code></pre>
</div>
</div>
<p>El caso 4:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>merge_data3<span class="ot">&lt;-</span>dplyr<span class="sc">::</span><span class="fu">right_join</span>(poblacion, </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                               ingresos_sueldos,</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">by=</span><span class="fu">c</span>(<span class="st">"folioviv"</span>, <span class="st">"foliohog"</span>, <span class="st">"numren"</span>))</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merge_data3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 105685    206</code></pre>
</div>
</div>
<p>También se puede usar con pipes, cualquier opción de dplyr</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>merge_data3<span class="ot">&lt;-</span>poblacion <span class="sc">%&gt;%</span> <span class="co"># pongo el conjunto que será la "izquierda</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">right_join</span>(ingresos_sueldos, </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by=</span><span class="fu">c</span>(<span class="st">"folioviv"</span>, <span class="st">"foliohog"</span>, <span class="st">"numren"</span>))</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merge_data3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 105685    206</code></pre>
</div>
</div>
</section>
<section id="cheatsheet-de-dplyr" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="cheatsheet-de-dplyr"><span class="header-section-number">4.8</span> Cheatsheet de <code>{dplyr}</code></h2>
<p>La puedes descargar de <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-transformation.pdf">aquí</a></p>
</section>
<section id="ejercicio" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="ejercicio"><span class="header-section-number">4.9</span> Ejercicio</h2>
<p>¡Junta tu base!</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./P3.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Análisis descriptivo</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./P5.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Ponderación y otros</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>